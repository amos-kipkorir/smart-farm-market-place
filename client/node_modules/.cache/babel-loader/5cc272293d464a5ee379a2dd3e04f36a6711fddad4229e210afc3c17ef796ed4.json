{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import{useParams,useNavigate}from'react-router-dom';import{Container,Row,Col,Card,Button,Badge}from'react-bootstrap';import api from'../services/api';import{useAuth}from'../context/AuthContext';import ProductReviews from'../components/ProductReviews';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProductDetail=()=>{const{id}=useParams();const navigate=useNavigate();const{user}=useAuth();const[product,setProduct]=useState(null);const[loading,setLoading]=useState(true);const fetchProduct=useCallback(async()=>{try{const response=await api.get(\"/api/products/\".concat(id));setProduct(response.data);}catch(error){console.error('Error fetching product:',error);}finally{setLoading(false);}},[id]);useEffect(()=>{fetchProduct();},[fetchProduct]);const handleOrder=()=>{// Navigate back to products with order modal\nnavigate('/products',{state:{orderProduct:product}});};const handleStartChat=()=>{navigate('/chat',{state:{selectedUserId:product.farmer_id}});};if(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-5\",children:\"Loading...\"});if(!product)return/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-5\",children:\"Product not found\"});return/*#__PURE__*/_jsxs(Container,{className:\"py-4\",children:[/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Card.Img,{variant:\"top\",src:product.image_url||'https://via.placeholder.com/400x300?text=Product+Image',style:{height:'400px',objectFit:'cover'}})})}),/*#__PURE__*/_jsxs(Col,{md:6,children:[/*#__PURE__*/_jsx(\"h1\",{children:product.name}),/*#__PURE__*/_jsx(Badge,{bg:\"secondary\",className:\"mb-3\",children:product.category}),/*#__PURE__*/_jsxs(\"h3\",{className:\"text-success\",children:[\"KSh \",product.price]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-muted\",children:[\"Available: \",product.quantity,\" units\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"lead\",children:product.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Farm:\"}),\" \",product.farm_name,/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"Farmer:\"}),\" \",product.farmer_name]}),user&&user.user_type==='buyer'&&/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex gap-2\",children:[/*#__PURE__*/_jsx(Button,{variant:\"success\",onClick:handleOrder,className:\"flex-fill\",children:\"Order Now\"}),/*#__PURE__*/_jsx(Button,{variant:\"outline-primary\",onClick:handleStartChat,className:\"flex-fill\",children:\"Chat with Farmer\"})]})]})]}),/*#__PURE__*/_jsx(Row,{className:\"mt-5\",children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(ProductReviews,{productId:product.id})})})]});};export default ProductDetail;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useParams","useNavigate","Container","Row","Col","Card","Button","Badge","api","useAuth","ProductReviews","jsx","_jsx","jsxs","_jsxs","ProductDetail","id","navigate","user","product","setProduct","loading","setLoading","fetchProduct","response","get","concat","data","error","console","handleOrder","state","orderProduct","handleStartChat","selectedUserId","farmer_id","className","children","md","Img","variant","src","image_url","style","height","objectFit","name","bg","category","price","quantity","description","farm_name","farmer_name","user_type","onClick","productId"],"sources":["/home/amos/Development/code/phase-4/smart-farm-market-place/client/src/pages/ProductDetail.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { Container, Row, Col, Card, Button, Badge } from 'react-bootstrap';\nimport api from '../services/api';\nimport { useAuth } from '../context/AuthContext';\nimport ProductReviews from '../components/ProductReviews';\n\nconst ProductDetail = () => {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const { user } = useAuth();\n  const [product, setProduct] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  const fetchProduct = useCallback(async () => {\n    try {\n      const response = await api.get(`/api/products/${id}`);\n      setProduct(response.data);\n    } catch (error) {\n      console.error('Error fetching product:', error);\n    } finally {\n      setLoading(false);\n    }\n  }, [id]);\n\n  useEffect(() => {\n    fetchProduct();\n  }, [fetchProduct]);\n\n  const handleOrder = () => {\n    // Navigate back to products with order modal\n    navigate('/products', { state: { orderProduct: product } });\n  };\n\n  const handleStartChat = () => {\n    navigate('/chat', { state: { selectedUserId: product.farmer_id } });\n  };\n\n  if (loading) return <div className=\"text-center py-5\">Loading...</div>;\n  if (!product) return <div className=\"text-center py-5\">Product not found</div>;\n\n  return (\n    <Container className=\"py-4\">\n      <Row>\n        <Col md={6}>\n          <Card>\n            <Card.Img \n              variant=\"top\" \n              src={product.image_url || 'https://via.placeholder.com/400x300?text=Product+Image'} \n              style={{ height: '400px', objectFit: 'cover' }}\n            />\n          </Card>\n        </Col>\n        <Col md={6}>\n          <h1>{product.name}</h1>\n          <Badge bg=\"secondary\" className=\"mb-3\">{product.category}</Badge>\n          <h3 className=\"text-success\">KSh {product.price}</h3>\n          <p className=\"text-muted\">Available: {product.quantity} units</p>\n          <p className=\"lead\">{product.description}</p>\n          \n          <div className=\"mb-3\">\n            <strong>Farm:</strong> {product.farm_name}<br/>\n            <strong>Farmer:</strong> {product.farmer_name}\n          </div>\n\n          {user && user.user_type === 'buyer' && (\n            <div className=\"d-flex gap-2\">\n              <Button variant=\"success\" onClick={handleOrder} className=\"flex-fill\">\n                Order Now\n              </Button>\n              <Button variant=\"outline-primary\" onClick={handleStartChat} className=\"flex-fill\">\n                Chat with Farmer\n              </Button>\n            </div>\n          )}\n        </Col>\n      </Row>\n\n      <Row className=\"mt-5\">\n        <Col>\n          <ProductReviews productId={product.id} />\n        </Col>\n      </Row>\n    </Container>\n  );\n};\n\nexport default ProductDetail;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}